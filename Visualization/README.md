visualize_movements.py is a tool that can be used to visualise lateral movement sessions generated by lateralmovementanalyzer.py. 
- It is possible to provide multiple session CSVs.
- This tool generates a visualization graph with the following naming convention : lateral_movement_DDMMYYYY_HHMM.html.

---
## Usage

```bash
python visualize_movements.py sessions.csv [more.csv ...]
```

## Offline installation
Script relies on PyVis and NetworkX to produce graphs. 
For an offline installation with .whl files, you can rely on requirements.txt or use the following pip command: 

```bash
pip install --no-index --no-deps --find-links=. pyvis networkx jinja2 jsonpickle MarkupSafe IPython traitlets stack_data executing asttokens pure_eval pygments decorator prompt_toolkit wcwidth
```

##How it works
- Load and merge CSV rows into a list of session records.
- Build a directed simple graph  with one edge per combination(src;dst)
- Each edge aggregates observed users, protocols, and directions into edge attributes.
- Render an interactive HTML graph using PyVis. Node labels are visible; edge details are available in the tooltip (title).


##Design choices
Single directed graph (DiGraph), not MultiDiGraph. One edge per direction, with aggregated attributes. 
This avoids compatibility issues with PyVis when rendering multiple parallel edges and ensures no loss of information.
IP Cleaning : port is removed from src and dst IPs fields.


###Prioritise data fidelity
the visualization preserves all observed users and protocols for a given src→dst direction by aggregating them on the edge.
Manual import into PyVis (use net.add_node / net.add_edge) instead of net.from_nx to ensure edge tooltips and colours are applied exactly as intended.

###Color Mapping
Color depends on protocol(s) used during a connection between two nodes :  
RDP : Red 
Powershell Remoting : Blue 
RDP and Powershell remoting : Green 
UNKNOWN : Gray 

###Edge model
Each edge stores:
users_list: semicolon-separated users observed for this src→dst.
protocols_list: semicolon-separated protocols observed.
directions_list: semicolon-separated directions (e.g. inbound, outbound).
title: tooltip string combining the above for display in the HTML.

###Single edge per (src;dst)
PyVis / vis.js handling of multiple parallel edges between the same node pair is fragile and can result in lost or collapsed edges or missing tooltips. 
Using a single edge per direction and aggregating session data guarantees no loss of user/protocol information while keeping the visual output deterministic and portable. 
Multiple sessions in the same direction are not shown as separate parallel arrows, but all session metadata is preserved in the edge tooltip.


